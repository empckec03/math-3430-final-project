---
title: "F1 Project"
author: "Hailey, Finn, Mia, Caili"
date: "2025-11-18"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(readxl)
library(tidyverse)
library(ggplot2)
library(dplyr)

results <- read_excel("Results.xlsx")

results

weather <- read_excel("Weather.xlsx")

weather
```

```{r}
results <- results %>%
  select(TeamName, FullName, Position, GridPosition, Status, Points, RoundNumber, EventName) %>%
  mutate(
    Position = as.integer(Position),
    GridPosition = as.integer(GridPosition),
    Points = as.integer(Points),
    RoundNumber = as.integer(RoundNumber)
  ) %>%
  rename (
    DriverName = FullName,
    Result = Position,
    QualiPosition = GridPosition
  )
  

results
```
```{r}
weather <- weather %>%
  select(Rainfall, TrackTemp, RoundNumber, EventName) %>%
  mutate(RoundNumber = as.integer(RoundNumber)) %>%
  rename(Rain = Rainfall)

weather
```


**The below section breaks the weather dataframe into 2 parts: track temperature and rainy races. The average track temperature for each race & round number is found. The number of races that had more than 10 true's under rain was also found.**
```{r}
track_only <- weather %>%
  group_by(EventName, RoundNumber) %>%
  summarize(AvgTrackTemp = mean(TrackTemp, na.rm=T)) %>%
  arrange(desc(AvgTrackTemp))

track_only


rain_only <- weather %>%
  group_by(EventName, RoundNumber) %>%
  summarize(NumRain = sum(Rain)) %>%
  filter(NumRain >= 10)

rain_only
```
**This is a bar graph of the average points scored per race for each driver during the '23 season. The bars are colored based on the team the driver drives for. It reveals that Max Verstappen has the highest average number of points scored each race and Sergio Perez had the second highest number of points scored each race. Both drivers race for Red Bull Racing. The plot reveals Verstappen and then Perez are the most consistent drivers and Red Bull Racing is the most consistent constructor. The least consistent drivers were Nyck De Vries (least reliable) and then Logan Sargeont. The least reliable constructors appear to be AlphaTauri, Haas, and Alfa Romeo.**
```{r}
results %>%
  group_by(DriverName, TeamName) %>%
  summarize(mean_pts_scored = mean(Points, na.rm = T), .groups = "drop") %>%
  ggplot(aes(x = reorder(DriverName, mean_pts_scored), y = mean_pts_scored))+
  geom_bar(stat = "identity", aes(color = TeamName, fill = TeamName))+
  coord_flip() +
  labs(y = "Mean Points Scored Per Race", x = "Driver Name", color = "Team Name", fill = "Team Name")
```

**Scatterplot of average track temp vs. total points scored by constructor.**
```{r}
results %>%
  group_by(TeamName, EventName, RoundNumber) %>%
  summarize(race_points = sum(Points), .groups = "drop") %>%
  arrange(desc(race_points)) -> team_pts_by_race

team_track <- team_pts_by_race %>%
  left_join(track_only, by = c("EventName", "RoundNumber"))

ggplot(data = team_track, aes(x = AvgTrackTemp, y = race_points, color = TeamName)) +
  geom_point() +
  labs(
    x = "Average Track Temperature (Â°C)", 
    y = "Constructor Points (Per Race)",
    title = "Track Temperature vs Constructor Points"
  ) +
  facet_wrap(~TeamName, ncol = 5)
```
**Red Bull consistent (but with some outliers in higher temp)**
**Mercedes, Ferrari all over the place- car upgrades after a bad race**
**Hass, Alfa Romeo, Williams consistently bad (slightly better in the middle)**
**Alpha Tauri, Mclaren better in higher temp**
**Aston Martin more consistent in colder temps, scattered in higher temps**
**Alpine did well in colder temps, consistent in higher temps (except for outlier)**



```{r}
results %>%
  group_by(TeamName, EventName, RoundNumber, DriverName) %>%
  summarize(race_points = sum(Points), .groups = "drop") %>%
  arrange(desc(race_points)) -> pts_by_race

individual_track <- pts_by_race %>%
  left_join(track_only, by = c("EventName", "RoundNumber"))

individual_track

ggplot(data = individual_track, aes(x=race_points, fill=DriverName)) +
  geom_bar() +
  facet_wrap(~TeamName, ncol=5) +
  theme(legend.position = "none")
```
